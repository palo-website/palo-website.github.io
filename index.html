<!doctype html>
<html>
  <head>
    <meta charset="iso-8859-1" />
    <meta name="description" content="Policy Adaptation via Language Optimization" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Policy Adaptation via Language Optimization: Decomposing Tasks for Few-Shot Imitation</title>
    <!-- Global site tag (gtag.js) - Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PZKFKSK4DD"></script>
    <script>
      window.dataLayer = window.dataLayer || []
      function gtag() {
        dataLayer.push(arguments)
      }
      gtag("js", new Date())
      gtag("config", "G-PZKFKSK4DD")
    </script>
    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet" />
    <link rel="stylesheet" href="./static/css/bulma.min.css" />
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css" />
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css" />
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" />
    <link rel="stylesheet" href="./static/css/index.css" />
    <link rel="icon" href="./static/images/favicon.svg" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
    <script
      type="text/javascript"
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  </head>
  <body>
    <section class="hero">
      <div class="hero-body">
        <div class="container is-max-desktop">
          <div class="columns is-centered">
            <div class="column has-text-centered">
              <h1 class="title is-1 publication-title">Policy Adaptation via Language Optimization</h1>
              <div class="is-size-5 publication-authors">
                <span class="author-block"><a href="https://people.eecs.berkeley.edu/~vmyers/">Vivek Myers*</a></span>
                <span class="author-block"><a href="">Bill Chunyuan Zheng*</a></span>
                <span class="author-block"><a href="https://www.oiermees.com">Oier Mees</a></span>
                <span class="author-block">
                  <a href="https://people.eecs.berkeley.edu/~svlevine/">Sergey Levine</a>
                </span>
                <span class="author-block"><a href="https://kuanfang.github.io">Kuan Fang</a></span>
              </div>
              <div class="is-size-5 publication-authors">
                <span class="author-block">University of California, Berkeley</span>
              </div>
              <div class="column has-text-centered">
                <div class="publication-links">
                  <span class="link-block px-1">
                    <a href="about:blank" class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Paper</span>
                    </a>
                  </span>
                  <span class="link-block px-1">
                    <a href="about:blank" class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="ai ai-arxiv"></i>
                      </span>
                      <span>arXiv</span>
                    </a>
                  </span>
                  <span class="link-block px-1">
                    <a href="https://people.eecs.berkeley.edu/~vmyers/palo/palo_video.mp4" class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-video"></i>
                      </span>
                      <span>Video</span>
                    </a>
                  </span>
                  <span class="link-block px-1">
                    <a
                      href="https://github.com/vivekmyers/palo"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-code"></i>
                      </span>
                      <span>Code</span>
                    </a>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="container is-max-desktop">
        <hr />
        <div class="columns is-centered has-text-centered">
          <div class="column">
            <div class="publication-video">
              <video id="overview" controls="" width="99%">
                <source src="https://people.eecs.berkeley.edu/~vmyers/palo/palo_video.mp4" type="video/mp4" />
              </video>
            </div>
          </div>
        </div>
        <hr />
        <div class="columns is-align-items-center has-text-justified">
          <div class="column is-8">
            <h2 class="title has-text-centered">Abstract</h2>
            <p>
              Learned language-conditioned robot policies often struggle to effectively adapt to new real-world tasks
              even when pre-trained across a diverse set of instructions. We propose a novel approach for few-shot
              adaptation to unseen tasks that exploits the semantic understanding of task decomposition provided by
              vision-language models (VLMs). Our method, Policy Adaptation via Language Optimization (PALO), combines a
              handful of demonstrations of a task with proposed language decompositions sampled from a VLM to quickly
              enable rapid nonparametric adaptation, avoiding the need for a larger fine-tuning dataset. We evaluate
              PALO on extensive real-world experiments consisting of challenging unseen, long-horizon robot manipulation
              tasks. We find that PALO is able of consistently complete long-horizon, multi-tier tasks in the real
              world, outperforming state of the art pre-trained generalist policies, and methods that have access to the
              same demonstrations.
            </p>
          </div>
          <div class="column is-4 columns">
            <div class="column is-10 is-offset-1 mt-5">
              <img src="./static/images/teaser_small.svg" alt="summary" />
            </div>
          </div>
        </div>
      </div>
      <div class="container is-max-desktop pb-5 mb-5">
        <hr />
        <div class="columns is-centered">
          <div class="container row py-2">
            <h2 class="title is-3">Policy Adaptation via Language Optimization</h2>
            <div class="col-8"><img class="w-100" src="./static/images/frontfig.svg" alt="summary" /></div>
            <div class="col-4 px-4 d-flex my-auto">
              <p>
                An overview of the PALO algorithm. (Left) We build off a pre-trained policy that has learned to follow
                low-level language instructions from a large dataset of expert demonstrations. (Middle) Given a new task
                and a few expert demonstrations, we use a VLM to propose candidate decompositions into subtasks. We
                optimize over these demonstrations, selecting the one that minimizes the validation error of the learned
                policy on these demonstrations. (Right) At test time, we condition the pre-trained policy on the
                selected decomposition to solve the task.
              </p>
            </div>
          </div>
        </div>
        <hr />
        <div class="columns is-centered">
          <div class="column is-full-width">
            <h2 class="title is-3">Examples</h2>

            <div class="content has-text-justified">
              <p>
                We provide example rollouts from PALO performing 8 different tasks. We include the low-level language
                decompositions instructions inferred by PALO on each frame of the video.
              </p>
            </div>
            <br />
            <div class="rows">
              <div class="columns">
                <div class="column has-text-justified quote">
                  <p class="instruction">Sweep the mints to the right after putting the mushroom into the pot</p>
                  <video id="dist1" muted autoplay="" loop="" width="99%">
                    <source src="./static/videos/mints.mp4" type="video/mp4" />
                  </video>
                </div>
                <div class="column has-text-justified quote">
                  <p class="instruction">
                    Sweep the skittles into the bin using the swiffer after putting the mushroom in the container
                  </p>
                  <video id="dist1" muted autoplay="" loop="" width="99%">
                    <source src="./static/videos/sweep_skittles.mp4" type="video/mp4" />
                  </video>
                </div>
                <div class="column has-text-justified quote">
                  <p class="instruction">Put the beet toy/purple thing into the drawer</p>
                  <video id="dist1" muted autoplay="" loop="" width="99%">
                    <source src="./static/videos/drawer_put.mp4" type="video/mp4" />
                  </video>
                </div>
                <div class="column has-text-justified quote">
                  <p class="instruction">Pry out the pot in the drawer using the ladle</p>
                  <video id="dist1" muted autoplay="" loop="" width="99%">
                    <source src="./static/videos/pry.mp4" type="video/mp4" />
                  </video>
                </div>
              </div>
              <div class="columns">
                <div class="column has-text-justified quote">
                  <p class="instruction">Pour the contents in the scoop into the bowl</p>
                  <video id="dist1" muted autoplay="" loop="" width="99%">
                    <source src="./static/videos/salad.mp4" type="video/mp4" />
                  </video>
                </div>
                <div class="column has-text-justified quote">
                  <p class="instruction">Make a salad bowl with corn and mushroom</p>
                  <video id="dist1" muted autoplay="" loop="" width="99%">
                    <source src="./static/videos/pour.mp4" type="video/mp4" />
                  </video>
                </div>
                <div class="column has-text-justified quote">
                  <p class="instruction">Put the spoon in the cleaner while aligning it</p>
                  <video id="dist1" muted autoplay="" loop="" width="99%">
                    <source src="./static/videos/spoon.mp4" type="video/mp4" />
                  </video>
                </div>
                <div class="column has-text-justified quote">
                  <p class="instruction">Put the marker in the white box while aligning it</p>
                  <video id="dist1" muted autoplay="" loop="" width="99%">
                    <source src="./static/videos/marker.mp4" type="video/mp4" />
                  </video>
                </div>
              </div>
            </div>
          </div>
        </div>
        <hr />
        <h2 class="title is-2">Evaluation</h2>
        <div class="container py-4">
          <div class="col-12 has-text-centered">
            <img width="80%" src="./static/images/comparison.svg" alt="comparison against baselines" />
          </div>

          <p>
            While evaluating on long-horizon and unseen skills tasks, PALO outperforms all conventional zero-shot
            generalization methods by 3x in terms of success rate, and improves upon conventional finetuning methods
            despite having only 5 expert demonstrations per task.
          </p>
          <p>
            Unlike previous finetuning methods that take up to 30 minutes to train given the dataset size, PALO is also
            computationally efficient, taking up only 470 seconds for optimization to finish.
          </p>
        </div>
        <div class="container py-4">
          <div class="col-12 has-text-centered">
            <img width="80%" src="./static/images/ablations.svg" alt="comparison against ablations" />
          </div>

          <p>
            Ablation studies show the all components of PALO are necessary for its success. We ablate the following:
          </p>
          <ol class="pl-5 py-3">
            <li>No high-level \(c_H\) conditioning for the learned policy via masking.</li>

            <li>No low-level \(c_L\) instruction conditioning via masking.</li>

            <li>Use fixed \(u\) in each trajectory to evaluate</li>

            <li>Generate \(c\) zero-shot without expert demonstrations.</li>

            <li>No VLM decomposition proposals by using only \(\ell\) within our policy.</li>
          </ol>
        </div>
        <hr />
        <script>
          function selectContent(query) {
            var range = document.createRange()
            var selection = window.getSelection()
            var elem = document.querySelector(query)
            range.selectNodeContents(elem)
            selection.removeAllRanges()
            selection.addRange(range)
          }
        </script>
        <h2 class="title is-2">BibTeX</h2>
        <pre id="bibtex" onclick="selectContent('#bibtex')"><code>@misc{myers2024policy,
  title = {Policy Adaptation via Language Optimization: Decomposing Tasks for Few-Shot Imitation},
  author = {Myers, Vivek and Zheng, Bill Chunyuan and Mees, Oier and Levine, Sergey and Fang, Kuan},
  year = {2024},
  langid = {english}
}
</code></pre>
      </div>
    </section>
  </body>
</html>
